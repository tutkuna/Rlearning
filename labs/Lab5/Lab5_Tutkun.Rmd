---
title: "Lab 5"
author: "Alp Tutkun"
date: "2/21/2020"
output: html_document
---

```{r}
#apply a func to mult cols in df 
# fake data
my.vars <- data.frame(a1=1:10, a2=11:20,b1=21:30,b2=31:40)
my.means <- sapply(my.vars,FUN=mean)
#plot 2 groups and 2 treats as bar plot
barplot(my.means)
my.mat <- cbind(my.means[c(1,3)],my.means[c(2,4)])
barplot(my.mat,beside=TRUE,names=c("a1","b1","a2","b2"))
my.mat <- cbind(my.means[c(1,2)],my.means[c(3,4)])
barplot(my.mat,beside=TRUE,names=c("a1","a2","b1","b2"))
#custom se func
my.se <- function(x){
  sd(x)/sqrt(length(x))
}
stderr <- sapply(my.vars,FUN=my.se)

ci.up <- my.means+1.96*stderr
ci.low <- my.means-1.96*stderr
bp <- barplot(my.mat,beside=TRUE,names=c("a1","a2","b1","b2"))
arrows(y0=ci.low[c(1,2,3,4)],y1=ci.up[c(1,2,3,4)],x0=bp,x1=bp,angle=90,code=3,length=0.1)
```
```{r}
colSums(my.vars)
```
```{r}
my.table <- cbind(c(5,21),c(65,56))
ftest <- fisher.test(my.table)
ftest$p.value
```
# task1
Use the 80% germination plant and 25% germination plant as controls. Calculate the germination rate of the new plant. You should replicate both controls and the experimental germination at least 10 times to get a calculable result, though 100 replicates would be better.
```{r}
d1 <- read.csv("gmo_dataset1.csv")
d1m <- sapply(d1[2:5],FUN=mean)
stderr <- sapply(d1[2:5],FUN=my.se)
ci.up <- d1m+1.96*stderr
ci.low <- d1m-1.96*stderr
my.mat <- cbind(d1m[c(1,3)],d1m[c(2,4)])
bp <- barplot(my.mat,beside=TRUE,names=c("gg","gn","wg","wn"))
arrows(y0=ci.low[c(1,3,2,4)],y1=ci.up[c(1,3,2,4)],x0=bp,x1=bp,angle=90,code=3,length=0.1)
#null hyp : wildtype and gmo have the same rate of germination
#alt hyp : gmo has different rate of germination
cs <- colSums(d1[2:5])
my.table <- cbind(cs[c(1,2)],cs[c(3,4)])
fisher.test(my.table)
# with a pvalue significantly less than 0.05, we can conclude that the gmo germination rate is statistically different from wt.
odds <- function(p1,p2,q1,q2){
  (p1/q1)/(p2/q2)
}
odds(d1m[1],d1m[3],d1m[2],d1m[4])
# 12.25 odds ratio is significantly greater than 1, showing that the gmo had a biologically significant effect on germination rate
#Convince: after GMO, the plant germinated at a very significantly higher rate, so we have achieved success, we can feed more people now woo!
```
# task2
```{r}
d2 <- read.csv("gmo_dataset2.csv")
# null hyp : wildtype and gmo have the same disease incidence rate
# alt hyp: different
cs <- colSums(d2[2:5])
my.table <- cbind(cs[c(1,3)],cs[c(2,4)])
fisher.test(my.table)
# p value is greater than 0.05 so we cannot conclude that gmo has any association with disease incidence
pvals <- rep(NA, nrow(d2))
for (i in 1:nrow(d2)) {
  x <- d2[i,]
  t <- matrix(unlist(cbind(x[c(2,4)],x[c(3,5)])),nrow=2)
  pvals[i] <- fisher.test(t)$p.value
}
```
only in india, there seems to be an association between disease incidence on gmo vs nongmo crops
since an overwhelming majority of countries does not exhibit a relationship between disease and gmo, there is no reason to ban or restrain it. The issue in india could be accounted to the location of the fields. gmo fields are likely grown close to each other and the disease spread physically likely in no part due to the gmo'ness of the crops.


