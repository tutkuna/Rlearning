wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("firebrick","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
lines(y=2.4)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
lines(x=null, y=2.4)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
lines(x=2.4, y=2.4)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
lines(x=0, y=2.4)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
abline(h=2.4)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
abline(h=2.4,col="firebrick", lty=3)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
abline(h=2.4,col="firebrick", lty=2)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
abline(h=2.4,col="firebrick", lty=2, lwd=3)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
migW<-subset(x=d3, subset=coast=="West")$migration
migE<-subset(x=d3, subset=coast=="East")$migration
migWm <- mean(migW)
migEm <- mean(migE)
sse1<-my.se(migW)
sse2<-my.se(migE)
wci.up<-migWm+1.96*sse1
eci.up<-migEm-1.96*sse2
wci.low<-migWm-1.96*sse1
eci.low<-migEm+1.96*sse2
bp <- barplot(cbind(migWm,migEm),ylim=c(0,5), ylab="means (m^2/s)", main="migration", names=c("West","East"), xlab="coast", col=c("hotpink","cyan"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(wci.low,eci.low),y1=c(wci.up,eci.up),angle=90,code=3,length=0.1)
abline(h=2.4,col="firebrick", lty=2, lwd=2)
f.test(migW,migE)
fisher.test(migW,migE)
var.test(migW,migE)
var.test(migW,migE) #, p<0.05, variances not equal so we do Welchs t-test
t.test(migW,migE)
setwd("C:/Users/AlpTutkun/Desktop/R/labs/Lab8")
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=30))
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=30))
head(my.df)
View(my.df)
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=1))
head(my.df)
View(my.df)
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=30))
head(my.df)
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3")))
head(my.df)
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=30))
head(my.df)
str(my.df)
# visualize data w/ boxplot
boxplot(response~treatment,data=my.df)
model <- aov(response~treatment,data=my.df)
par(mfrow=c(2,2))
plot(model)
act(model$residuals)
#acf plot checks for autocorrelation
par(mfrow=c(1,1))
act(model$residuals)
acf(model$residuals)
#get anove table
summary(model)
mod.tukey <- TukeyHSD(model)
mod.tukey
plot(mod.tukey)
install.packages('multcompView')
#install.packages('multcompView')
require(multcompView)
str(mod.tukey)
multcompLetters(mod.tukey$treatment)
multcompLetters(mod.tukey$treatment[,"p adj"])$Letters
str(labes)
str(labels)
labes <- multcompLetters(mod.tukey$treatment[,"p adj"])$Letters
str(labels)
labels <- multcompLetters(mod.tukey$treatment[,"p adj"])$Letters
str(labels)
d1 <- read.csv("ANOVA_dataset1.csv")
head(d1)
levels(d1)
levels(d1$treatment)
str(d1)
hist(d1$mortality)
par(mfrow=c(2,1))
hist(d1$mortality, main="raw")
hist(log10(d1$mortality),main="log10")
mod1 <- aov(log10(mortality)~treatment,data=d1)
summary(mod1)
mod.tukey1 <- TukeyHSD(mod1)
mod.tukey1
par(mfrow=c(1,1))
plot(mod.tukey1)
require(multcompView)
labels1 <- multcompLetters(mod.tukey$treatment[,"p adj"])$letters
labels1 <- labels1[order(names(labels1))]
(labels1 <- labels1[order(names(labels1))])
labels1 <- multcompLetters(mod.tukey$treatment[,"p adj"])$letters
labels1 <- labels1[order(names(labels1))]
labels1 <- multcompLetters(mod.tukey1$treatment[,"p adj"])$letters
labels1 <- labels1[order(names(labels1))]
labels1 <- multcompLetters(mod.tukey1$treatment[,"p adj"])$letters
labels1 <- labels1[order(names(labels1))]
multcompLetters(mod.tukey1$treatment[,"p adj"])$letters
mod.tukey1$treatment[,"p adj"])$letters
mod.tukey1
mod.tukey1$treatment
mod.tukey1$treatment[,"p adj"]
mod.tukey1$treatment[,"p adj"]
multcompLetters(mod.tukey1$treatment[,"p adj"])
labels1 <- multcompLetters(mod.tukey1$treatment[,"p adj"])$Letters
labels1 <- labels1[order(names(labels1))]
labels1
means <- aggregate(mortality~treatment,mean,data=d1)
# Chunk 1
my.df <- data.frame(response=c(rnorm(30,mean=1.1),rnorm(30,mean=1), rnorm(30,mean=2)),treatment=rep(c("T1","T2","T3"),each=30))
head(my.df)
str(my.df)
# visualize data w/ boxplot
boxplot(response~treatment,data=my.df)
model <- aov(response~treatment,data=my.df)
# Chunk 2
par(mfrow=c(2,2))
plot(model)
#resid v fitted: linearity - red line flat. homoscedasticity - no wedge in resids
#normal qq-plot: data following 1:1 line is normal dist
#scale-location: no obv. trend
#resids leverage: helps identify influential data pts.
#outliest can be influential but not necessarily
#some pts in normal range can also be influential
#look for pts. at extremes, outside dashed line (cook's dst)
#acf plot checks for autocorrelation
par(mfrow=c(1,1))
acf(model$residuals)
# Chunk 3
#get anove table
summary(model)
# Chunk 4
mod.tukey <- TukeyHSD(model)
plot(mod.tukey)
# Chunk 5
#install.packages('multcompView')
require(multcompView) #tells if package DNE
str(mod.tukey)
labels <- multcompLetters(mod.tukey$treatment[,"p adj"])$Letters
str(labels)
# Chunk 6
d1 <- read.csv("ANOVA_dataset1.csv")
head(d1)
levels(d1$treatment)
levels(d1$treatment) <- c("con","t1","t2","t3","t4") #rename control to con
# Chunk 7
str(d1)
hist(d1$mortality) #not normal: extreme skew to low mort vals
# Chunk 8
par(mfrow=c(2,1))
hist(d1$mortality, main="raw")
hist(log10(d1$mortality),main="log10")
# Chunk 9
mod1 <- aov(log10(mortality)~treatment,data=d1)
summary(mod1)
# Chunk 10
mod.tukey1 <- TukeyHSD(mod1)
# Chunk 11
par(mfrow=c(1,1))
plot(mod.tukey1)
#fig shows diff. in means(x) between pairs of groups (y)
#error bars 95% ci around true mean diff between treat groups
# Chunk 12
require(multcompView)
# Chunk 13
labels1 <- multcompLetters(mod.tukey1$treatment[,"p adj"])$Letters
labels1 <- labels1[order(names(labels1))]
# Chunk 14
means1 <- aggregate(mortality~treatment,mean,data=d1)
means1 <- aggregate(mortality~treatment,mean,data=d1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
stderrs1 <- aggregate(mortality ~ treatment, FUN = se.fun, data = d1)
means1 <- aggregate(mortality~treatment,mean,data=d1)
se.fun <- function(x){
sd(x)/sqrt(length(x))
}
stderrs1 <- aggregate(mortality ~ treatment, FUN = se.fun, data = d1)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mort of pers", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality-stderrs1$mortality,y1=means1$mortality+stderrs1$mortality,code=1,angle=90,length=0.1)
box()
means1 <- aggregate(mortality~treatment,mean,data=d1)
se.fun <- function(x){
sd(x)/sqrt(length(x))
}
stderrs1 <- aggregate(mortality ~ treatment, FUN = se.fun, data = d1)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mort of pers", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=1, angle=90, length=0.1)
box()
means1 <- aggregate(mortality~treatment,mean,data=d1)
se.fun <- function(x){
sd(x)/sqrt(length(x))
}
stderrs1 <- aggregate(mortality ~ treatment, FUN = se.fun, data = d1)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mort of pers", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mortality of pers", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
### adv coding q
not.t3 <- subset(d1, treatment == "con" | treatment == "t1" | treatment == "t2" | treatment == "t4", drop = FALSE)
View(not.t3)
View(d1)
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
View(not.t3)
not.t3 <- subset(d1, treatment == "con" | treatment == "t1" & treatment == "t2" & treatment == "t4", drop = FALSE)
View(not.t3)
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
View(not.t3)
#p1
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
#p2
par(mfrow=c(2,1))
hist(d1$mortality, main="raw")
hist(log10(d1$mortality),main="log10")
#p1
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
#p2
par(mfrow=c(2,1))
hist(not.t3$mortality, main="raw")
hist(log10(not.t3$mortality),main="log10")
modnt3 <- aov(log10(mortality)~treatment,data=not.t3)
summary(modnt3)
mod.tukeynt3 <- TukeyHSD(modnt3)
mod.tukeynt3
plot(mod.tukeynt3)
plot(mod.tukeynt3)
)
)
par(mfrow=c(1,1))
plot(mod.tukeynt3)
d2 <- read.csv("ANOVA_dataset2.csv")
mod2 <- aov(log10(mortality) ~ treatment, data = d2)
par(mfrow=c(2,2))
plot(mod2)
summary(mod2)
mod.tukey2 <- TukeyHSD(mod2)
mod.tukey2
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2)
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2) bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2) bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2) bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2) bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
par(mfrow=c(1,1))
means2 <- aggregate(mortality~treatment,mean,data=d2)
stderrs2 <- aggregate(mortality~treatment,FUN=se.fun,data=d2)
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
par(mfrow=c(2,1))
par(mfrow=c(2,1))
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mortality of pers", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
par(mfrow=c(2,1))
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mean mort of pest predator/enemy", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mean mortality of pests", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
par(mfrow=c(2,1))
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mm pred", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mm pests", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
par(mfrow=c(1,2))
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mm pred", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mm pests", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
#p1
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
#p2
par(mfrow=c(2,1))
hist(not.t3$mortality, main="raw")
hist(log10(not.t3$mortality),main="log10")
modnt3 <- aov(log10(mortality)~treatment,data=not.t3)
summary(modnt3)
mod.tukeynt3 <- TukeyHSD(modnt3)
par(mfrow=c(1,1))
plot(mod.tukeynt3)
par(mfrow=c(1,2))
bp <- barplot(means2$mortality,names=means2$treatment,ylab="mm pred", ylim=range(c(0,max(means2$mortality+stderrs2$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means2$mortality-stderrs2$mortality,y1=means2$mortality+stderrs2$mortality,code=3,angle=90,length=0.1)
box()
labels2 <- multcompLetters(mod.tukey2$treatment[,"p adj"])$Letters
labels2 <- labels2[c("control","t1","t2","t3","t4")]
text(x=bp,y=means2$mortality+stderrs2$mortality,labels2,pos=3)
bp <- barplot(means1$mortality,names=means1$treatment,ylab="mm pests", ylim=range(c(0,max(means1$mortality+stderrs1$mortality)+2)))
arrows(x0=bp,x1=bp,y0=means1$mortality - stderrs1$mortality, y1=means1$mortality + stderrs1$mortality, code=3, angle=90, length=0.1)
box()
text(x=bp,y=means1$mortality+stderrs1$mortality,labels1,pos=3)
# how is b right?
#p1
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
#p2
par(mfrow=c(2,1))
hist(not.t3$mortality, main="raw")
hist(log10(not.t3$mortality),main="log10")
modnt3 <- aov(log10(mortality)~treatment,data=not.t3)
summary(modnt3)
mod.tukeynt3 <- TukeyHSD(modnt3)
par(mfrow=c(1,1))
plot(mod.tukeynt3)
mod.tukeynt3
#p1
not.t3 <- subset(d1, !treatment == "t3", drop = FALSE)
#p2
par(mfrow=c(2,1))
hist(not.t3$mortality, main="raw")
hist(log10(not.t3$mortality),main="log10")
modnt3 <- aov(mortality~treatment,data=not.t3)
summary(modnt3)
mod.tukeynt3 <- TukeyHSD(modnt3)
par(mfrow=c(1,1))
plot(mod.tukeynt3)
