plot(x,celnofood,type="l", xlab="Time (days)", ylab="Worms surviving", main="Survival of C. elegans with no food")
points(ocnofood, col="dark gray", type="l")
points(ocwcelnofood, col="green", type="l")
points(celwocnofood, col="blue", type="l")
points(occebt, col="purple", type="l")
points(ceocbt, col="red", type="l")
legend(x=4.45,y=21,legend=c("C. elegans no food","O. Carolinensis no food", "O. carolinensis with C. e no food", "C. elegans with O. c no food", "O. carolinensis with C. e Bt4A4","C. elegans with O. c Bt4A4"),lty=1,col=c("black","dark grey", "green", "blue", "purple", "red"),cex=0.6)
occebt <- c(20,18,16,11,6,2)
plot(x,celnofood,type="l", xlab="Time (days)", ylab="Worms surviving", main="Survival of C. elegans with no food")
points(ocnofood, col="dark gray", type="l")
points(ocwcelnofood, col="green", type="l")
points(celwocnofood, col="blue", type="l")
points(occebt, col="purple", type="l")
points(ceocbt, col="red", type="l")
legend(x=4.45,y=21,legend=c("C. elegans no food","O. Carolinensis no food", "O. carolinensis with C. e no food", "C. elegans with O. c no food", "O. carolinensis with C. e Bt4A4","C. elegans with O. c Bt4A4"),lty=1,col=c("black","dark grey", "green", "blue", "purple", "red"),cex=0.6)
celnofood <- c(20,18,17,12,5,2)
plot(x,celnofood,type="l", xlab="Time (days)", ylab="Worms surviving", main="Survival of C. elegans with no food")
points(ocnofood, col="dark gray", type="l")
points(ocwcelnofood, col="green", type="l")
points(celwocnofood, col="blue", type="l")
points(occebt, col="purple", type="l")
points(ceocbt, col="red", type="l")
legend(x=4.45,y=21,legend=c("C. elegans no food","O. Carolinensis no food", "O. carolinensis with C. e no food", "C. elegans with O. c no food", "O. carolinensis with C. e Bt4A4","C. elegans with O. c Bt4A4"),lty=1,col=c("black","dark grey", "green", "blue", "purple", "red"),cex=0.6)
ocnofood <- c(20,19,18,13,6,3)
plot(x,celnofood,type="l", xlab="Time (days)", ylab="Worms surviving", main="Survival of C. elegans with no food")
points(ocnofood, col="dark gray", type="l")
points(ocwcelnofood, col="green", type="l")
points(celwocnofood, col="blue", type="l")
points(occebt, col="purple", type="l")
points(ceocbt, col="red", type="l")
legend(x=4.45,y=21,legend=c("C. elegans no food","O. Carolinensis no food", "O. carolinensis with C. e no food", "C. elegans with O. c no food", "O. carolinensis with C. e Bt4A4","C. elegans with O. c Bt4A4"),lty=1,col=c("black","dark grey", "green", "blue", "purple", "red"),cex=0.6)
plot(x,celnofood,type="l", xlab="Time (days)", ylab="Worms surviving", main="Survival curves of nematodes")
points(ocnofood, col="dark gray", type="l")
points(ocwcelnofood, col="green", type="l")
points(celwocnofood, col="blue", type="l")
points(occebt, col="purple", type="l")
points(ceocbt, col="red", type="l")
legend(x=4.45,y=21,legend=c("C. elegans no food","O. Carolinensis no food", "O. carolinensis with C. e no food", "C. elegans with O. c no food", "O. carolinensis with C. e Bt4A4","C. elegans with O. c Bt4A4"),lty=1,col=c("black","dark grey", "green", "blue", "purple", "red"),cex=0.6)
plot(x,z[,1], type="l", col="black", xlab = "x",ylab = "z")
pF2 <- 0.0003 #P(F1)
pF1nF2 <- 0.001 #P(F1| !F2)
pF1F2 <- 0.001 #P(F1|F2)
pF1 <- pF2*pF1F2 + (1-pF2)*pF1nF2 #0.001 P(F1)
pF1*pF2 == pF2*pF1F2 #true, so independent
prF2 <- c(0.2,0.4,0.6,0.8)
pDnF2 <- seq(0.01,0.5, len= 100)
PDF2 <- 0.7
pF2D <- matrix(nrow=4, ncol=100)
bayes <- function(f2,dnf2){
(f2*0.7)/(0.7*f2 + (1-f2)*dnf2)
}
for(i in 1:length(prF2)){
for(j in 1:length(pDnF2)){
pF2D[i,j] <- bayes(prF2[i],pDnF2[j])
}
}
#Like the example we did in class where x is the P(D!|F2) and z is P(F2|D)
plot(x,z[,1], type="l", col="black", xlab = "x",ylab = "z")
prF2 <- c(0.2,0.4,0.6,0.8)
pDnF2 <- seq(0.01,0.5, len= 100)
PDF2 <- 0.7
pF2D <- matrix(nrow=4, ncol=100)
bayes <- function(f2,dnf2){
(f2*0.7)/(0.7*f2 + (1-f2)*dnf2)
}
for(i in 1:length(prF2)){
for(j in 1:length(pDnF2)){
pF2D[i,j] <- bayes(prF2[i],pDnF2[j])
}
}
pF2D
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.35,pF2[1:4],title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.4,pF2[1:4],title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.5,pF2[1:4],title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,pF2[1:4],title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,pF2[1:4],title="P(SwineFlu)",lty=1,legend=c("P(F2)=0.2","P(F2)=0.4","P(F2)=0.6","P(F2)=0.8"),col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,legend=pF2,title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,legend=prF2,title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf1 <- matrix(nrow=4, ncol=100)
for(i in 1:length(pf1v2)){
pf1[i,] <- pf1v1*pv1 + pf1v2*pv2
}
pf1
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf1 <- matrix(nrow=4, ncol=100)
for(i in 1:length(pf1v2)){
pf1[i,] <- pf1v1*pv1 + pf1v2[i]*pv2
}
pf1
pf2 <- pf2v1*pv1 +pf2v2*pv2
pf2
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf <- matrix(nrow=4, ncol=100)
for(i in 1:length(pf1v2)){
pf[i,] <- pf1v1*pv1 + pf1v2[i]*pv2 +pf2v1*pv1 +pf2v2*pv2
}
pf
plot(pv1,pf[1,],col="black")
points(pf[2,],col="red")
point(pf[3,],col="aquamarine")
plot(pv1,pf[1,],col="black")
points(pf[2,],col="red")
points(pf[3,],col="aquamarine")
points(pf[4,],col="darkseagreen2")
plot(pv1,pf[1,],col="black")
points(pv1,pf[2,],col="red")
points(pv1,pf[3,],col="aquamarine")
points(pv1,pf[4,],col="darkseagreen2")
plot(pv1,pf[1,],col="black", type="l")
points(pv1,pf[2,],col="red")
points(pv1,pf[3,],col="aquamarine")
points(pv1,pf[4,],col="darkseagreen2")
plot(pv1,pf[1,],col="black", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="red", type="l")
points(pv1,pf[3,],col="aquamarine",type="l")
points(pv1,pf[4,],col="darkseagreen2",type="l")
plot(pv1,pf[1,],col="black", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="red", type="l")
points(pv1,pf[3,],col="blue",type="l")
points(pv1,pf[4,],col="green",type="l")
plot(pv1,pf[1,],col="black", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="red", type="l")
points(pv1,pf[3,],col="blue",type="l")
points(pv1,pf[4,],col="darkseagreen4",type="l")
plot(pv1,pf[1,],col="black", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="red", type="l")
points(pv1,pf[3,],col="blue",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="red", type="l")
points(pv1,pf[3,],col="blue",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="blue",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="aquamarine",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="maroon",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="babyblue",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.8,0.8,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"))
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.8,0.8,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.9,0.3,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1))
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pf1")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pf1v2")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.85,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.9,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.875,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.88,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
pF2 <- 0.0003 #P(F1)
pF1nF2 <- 0.001 #P(F1| !F2)
pF1F2 <- 0.001 #P(F1|F2)
pF1 <- pF2*pF1F2 + (1-pF2)*pF1nF2 #0.001 P(F1)
pF1*pF2 == pF2*pF1F2 #true, so independent
prF2 <- c(0.2,0.4,0.6,0.8)
pDnF2 <- seq(0.01,0.5, len= 100)
PDF2 <- 0.7
pF2D <- matrix(nrow=4, ncol=100)
bayes <- function(f2,dnf2){
(f2*0.7)/(0.7*f2 + (1-f2)*dnf2)
}
for(i in 1:length(prF2)){
for(j in 1:length(pDnF2)){
pF2D[i,j] <- bayes(prF2[i],pDnF2[j])
}
}
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,legend=prF2,title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf <- matrix(nrow=4, ncol=100)
for(i in 1:length(pf1v2)){
pf[i,] <- pf1v1*pv1 + pf1v2[i]*pv2 +pf2v1*pv1 +pf2v2*pv2
}
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.88,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
fludata<-read.csv("assn1_dataset1.csv")
fludata<-read.csv("assn1_dataset1.csv")
setwd("C:/Users/AlpTutkun/Desktop/R/BiostatsLabAssn1/data")
setwd("C:/Users/AlpTutkun/Desktop/R/BiostatsLabAssn1/data") #change depending on own location
fludata<-read.csv("assn1_dataset1.csv")
str(fludata)
head(fludata)
aggregate(age~flu,FUN=mean,data=fludata) #Swine = 42.7750, Seasonal = 43.3625
aggregate(age~flu,FUN=range,data=fludata) #Swine = 17-66, Seasonal = 1-85
par(mfrow=c(1,2))
hist(subset(fludata, flu"seasonal"))
hist(subset(fludata, flu="seasonal"))
par(mfrow=c(1,2))
hist(0:90,subset(fludata, flu="seasonal"))
hist(subset(fludata, flu="seasonal"), xlab="age", ylab="frequency",xlim=c(0,90))
par(mfrow=c(1,2))
hist(subset(fludata, select=flu=="seasonal"), xlab="age", ylab="frequency",xlim=c(0,90))
par(mfrow=c(1,2))
hist(subset(fludata, subset=flu=="seasonal"), xlab="age", ylab="frequency",xlim=c(0,90))
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90))
setwd("C:/Users/AlpTutkun/Desktop/R/BiostatsLabAssn1/data") #change depending on own location
fludata<-read.csv("assn1_dataset1.csv")
str(fludata)
head(fludata)
aggregate(age~flu,FUN=mean,data=fludata) #Swine = 42.7750, Seasonal = 43.3625
aggregate(age~flu,FUN=range,data=fludata) #Swine = 17-66, Seasonal = 1-85
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90))
subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90)
subset(fludata,subset=flu=="swine")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90))
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90))
subset(fludata,subset=flu=="swine")
hist(subset(fludata,subset=flu=="swine"), xlab="age", ylab="frequency",xlim=c(0,90))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90))
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="cherry")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="tomato")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="banana")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="pineapple")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="plum")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="darkseagreen2")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="darkseagreen2", main="seasonal")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="black", main="seasonal")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="darkseagreen2", main="seasonal")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,91),col="darkseagreen2", main="seasonal")
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="darkseagreen2", main="seasonal")
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=65>age>18))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age>18))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age>18,subset=age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age==18:65)
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age==18:65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age==18:65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata,subset=age==18:65))
subset(fludata,subset=age==18:65)
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65)
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
data=subset(fludata, age>18 | age<65)
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>18 | age<65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>17 | age<66))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>17 | age<66))
seii <- aggregate(age~flu,FUN=sum,data=subset(fludata, age<18 | age>65))
sei <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>17 | age<66))
seii <- aggregate(age~flu,FUN=sum,data=subset(fludata, age<18 | age>65))
data.frame(sei,seii)
si <- aggregate(age~flu,FUN=sum,data=subset(fludata, age>17 | age<66))
sii <- aggregate(age~flu,FUN=sum,data=subset(fludata, age<18 | age>65))
data.frame(sei,seii)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 | age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
data.frame(sei,seii)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
data.frame(sei,seii)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
data.frame(sei,seii)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
data.frame(si,sii)
data.frame(adults=si,children_and_elderly=sii)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
data.frame(adults=si,children_and_elderly=sii$age)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(adults=si,children_and_elderly=sii$age)
mosaicplot(df)
df
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(flu=si$flu ,adults=si$age,children_and_elderly=sii$age)
df
mosaicplot(df$)
mosaicplot(df)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(flu=si$flu ,adults=si$age,children_and_elderly=sii$age)
df
mosaicplot(df)
mosaicplot(table(df)
mosaicplot(table(df))
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(rownames=si$flu ,adults=si$age,children_and_elderly=sii$age)
df
mosaicplot(df)
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(row.names=si$flu ,adults=si$age,children_and_elderly=sii$age)
df
mosaicplot(df)
mosaicplot(df, main="title")
mosaicplot(df, main="title", col=TRUE)
View(sii)
chisq.test(df$adults,df$children_and_elderly)
mosaicplot(df, main="title", col=TRUE)
chisq.test(df)
pF2 <- 0.0003 #P(F1)
pF1nF2 <- 0.001 #P(F1| !F2)
pF1F2 <- 0.001 #P(F1|F2)
pF1 <- pF2*pF1F2 + (1-pF2)*pF1nF2 #0.001 P(F1)
pF1*pF2 == pF2*pF1F2 #true, so independent
prF2 <- c(0.2,0.4,0.6,0.8)
pDnF2 <- seq(0.01,0.5, len= 100)
PDF2 <- 0.7
pF2D <- matrix(nrow=4, ncol=100)
bayes <- function(f2,dnf2){
(f2*0.7)/(0.7*f2 + (1-f2)*dnf2)
}
for(i in 1:length(prF2)){
for(j in 1:length(pDnF2)){
pF2D[i,j] <- bayes(prF2[i],pDnF2[j])
}
}
plot(pDnF2,pF2D[1,],type="l",col="black",main="Rate of True Swine Flu Detection vs. False Detection Rate",xlab="False Detection Rate",ylab="Swine Flu Contraction Rate Given Detection", xlim=c(0,0.55), ylim=c(0,1.05))
lines(pDnF2,pF2D[2,],col="magenta")
lines(pDnF2,pF2D[3,],col="aquamarine")
lines(pDnF2,pF2D[4,],col="darkgoldenrod3")
abline(h=0.5,untf=FALSE,lty=2)
legend(0.00,0.45,legend=prF2,title="P(SwineFlu)",lty=1,col=c("black","magenta","aquamarine","darkgoldenrod3"))
pf1v1 <- 0.05
pf2v1 <- 0.4
pf2v2 <- 0.05
pf1v2 <-  c(0.2, 0.4, 0.6, 0.8)
pv1 <- seq(0.001,1, len= 100)
pv2 <- 1-pv1
pf <- matrix(nrow=4, ncol=100)
for(i in 1:length(pf1v2)){
pf[i,] <- pf1v1*pv1 + pf1v2[i]*pv2 +pf2v1*pv1 +pf2v2*pv2
}
plot(pv1,pf[1,],col="plum", type="l", ylim=c(0,1),ylab="total prevalence of flu",xlab="pv1 (1-pv2)")
points(pv1,pf[2,],col="hotpink", type="l")
points(pv1,pf[3,],col="royalblue2",type="l")
points(pv1,pf[4,],col="darkseagreen3",type="l")
legend(0.88,0.35,pf1v2,title="pf1v2",col=c("plum","hotpink","royalblue2","darkseagreen3"), lty=1)
setwd("C:/Users/AlpTutkun/Desktop/R/BiostatsLabAssn1/data") #change depending on own location
fludata<-read.csv("assn1_dataset1.csv")
str(fludata)
head(fludata)
aggregate(age~flu,FUN=mean,data=fludata) #Swine = 42.7750, Seasonal = 43.3625
aggregate(age~flu,FUN=range,data=fludata) #Swine = 17-66, Seasonal = 1-85
par(mfrow=c(1,2))
hist(subset(fludata,subset=flu=="swine")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="royalblue2", main="swine")
hist(subset(fludata,subset=flu=="seasonal")$age, xlab="age", ylab="frequency",xlim=c(0,90),col="darkseagreen2", main="seasonal")
si <- aggregate(age~flu,FUN=length,data=subset(fludata, age>17 & age<66))
sii <- aggregate(age~flu,FUN=length,data=subset(fludata, age<18 | age>65))
df <- data.frame(row.names=si$flu ,adults=si$age,children_and_elderly=sii$age)
df
mosaicplot(df, main="title", col=TRUE)
chisq.test(df)
