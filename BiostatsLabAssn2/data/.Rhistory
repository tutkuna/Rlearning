str(period)
benguela$period <- ifelse(benguela$year<2025,"before", "after")
View(benguela)
benguela$period <- ifelse(benguela$year<2025,"before", "after")
california$period <- ifelse(california$year<2025,"before", "after")
canary$period <- ifelse(canary$year<2025,"before", "after")
humboldt$period <- ifelse(humboldt$year<2025,"before", "after")
View(humboldt)
benf <- data.frame(benguela$year,benguela$period,rowMeans(benguela))
benf <- c(benguela$year,benguela$period,rowMeans(benguela))
View(benguela)
View(benguela)
View(canary)
benf <- data.frame(benguela$year,benguela$period,rowMeans(select_if(benguela, is.numeric))))
benf <- data.frame(benguela$year,benguela$period,rowMeans(select_if(benguela, is.numeric)))
benf <- data.frame(benguela$year,benguela$period,rowMeans(subset(benguela, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
View(benf)
benf <- data.frame(benguela$year,benguela$period,rowMeans(subset(benguela, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
calf <- data.frame(california$year,california$period,rowMeans(subset(california, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
View(calf)
benf <- data.frame(benguela$year,benguela$period,rowMeans(subset(benguela, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
calf <- data.frame(california$year,california$period,rowMeans(subset(california, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
canf <- data.frame(canary$year,canary$period,rowMeans(subset(canary, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
humf <- data.frame(humboldt$year,humboldt$period,rowMeans(subset(humboldt, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22"))))
View(humboldt)
View(humf)
shapiro.test(subset(benf,subset=benf$benguela.period=="before"))
shapiro.test(subset(benf,subset=benf$period=="before"))
shapiro.test(subset(benf,subset=benf$period=="before"))
shapiro.test(subset(benf,subset=benf$period=="before"))
shapiro.test(subset(benf,subset=benf$period=="before"))
shapiro.test(subset(benf,subset=benf$period=="before"))
View(benf)
View(benf)
View(benf)
bmean <- rowMeans(subset(benguela, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22")))
benf <- data.frame(benguela$year,benguela$period,bmean)
View(benf)
mean <- rowMeans(subset(benguela, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22")))
benf <- data.frame(benguela$year,benguela$period,mean)
mean <- rowMeans(subset(california, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22")))
calf <- data.frame(california$year,california$period,mean)
mean <- rowMeans(subset(canary, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22")))
canf <- data.frame(canary$year,canary$period, mean)
mean <- rowMeans(subset(humboldt, select=c("model1","model2","model3","model4","model5","model6","model7","model8","model9","model10","model11","model12","model13","model14","model15","model16","model17","model18","model19","model20","model21","model22")))
humf <- data.frame(humboldt$year,humboldt$period,mean)
View(humf)
shapiro.test(subset(subset(benf,subset=benf$period=="before"), select="mean"))
shapiro.test(subset(subset(benf,subset=benf$period=="before"), select=c("mean"))
View(benf)
shapiro.test(subset(benf,subset=benf$period=="before")$mean)
subset(benf,subset=benf$period=="before")
View(benf)
shapiro.test(subset(benf,subset=period=="before")$mean)
shapiro.test(subset(benf,subset=period=="before")$mean)
shapiro.test(subset(benf,subset=period=="before")$mean)
shapiro.test(subset(benf,subset=period=="after")$mean)
shapiro.test(subset(calf,subset=period=="before")$mean)
shapiro.test(subset(calf,subset=period=="after")$mean)
shapiro.test(subset(canf,subset=period=="before")$mean)
shapiro.test(subset(canf,subset=period=="after")$mean)
shapiro.test(subset(humf,subset=period=="before")$mean)
shapiro.test(subset(humf,subset=period=="after")$mean)
wilcox.test(benf)
wilcox.test(benf$mean)
wilcox.test(benf$mean)
wilcox.test(calf$mean)
wilcox.test(canf$mean)
wilcox.test(humf$mean)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-score.se(s1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<mb+1.96*sse1
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma), names=c("before","after"), ylab="benguela")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1) names=c("before","after"), ylab="benguela")
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="benguela")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
View(benguela)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", title="benguela")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", main="benguela")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=calf, subset=period=="before")$mean
s2<-subset(x=calf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", main="california")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=calf, subset=period=="before")$mean
s2<-subset(x=calf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.4), names=c("before","after"), ylab="means", main="california")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=canf, subset=period=="before")$mean
s2<-subset(x=canf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", main="canary")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=canf, subset=period=="before")$mean
s2<-subset(x=canf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.7), names=c("before","after"), ylab="means", main="canary")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=humf, subset=period=="before")$mean
s2<-subset(x=humf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=humf, subset=period=="before")$mean
s2<-subset(x=humf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.5), names=c("before","after"), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
s1<-subset(x=benf, subset=period=="before")$mean
s2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,1), names=c("before","after"), ylab="means", main="benguela")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=calf, subset=period=="before")$mean
s2<-subset(x=calf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.4), names=c("before","after"), ylab="means", main="california")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=canf, subset=period=="before")$mean
s2<-subset(x=canf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.7), names=c("before","after"), ylab="means", main="canary")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
s1<-subset(x=humf, subset=period=="before")$mean
s2<-subset(x=humf, subset=period=="after")$mean
mb <- mean(s1)
ma <- mean(s2)
sse1<-my.se(s1)
sse2<-my.se(s2)
ci.up1<-mb+1.96*sse1
ci.up2<-ma-1.96*sse2
ci.low1<-mb-1.96*sse1
ci.low2<-ma+1.96*sse2
bp <- barplot(c(mb,ma),ylim=c(0,0.5), names=c("before","after"), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(ci.low1,ci.low2),y1=c(ci.up1,ci.up2),angle=90,code=3,length=0.1)
my.se <- function(x){
sd(x)/sqrt(length(x))
}
bs1<-subset(x=benf, subset=period=="before")$mean
bs2<-subset(x=benf, subset=period=="after")$mean
mb <- mean(bs1)
ma <- mean(bs2)
sse1<-my.se(bs1)
sse2<-my.se(bs2)
bci.up1<-mb+1.96*sse1
bci.up2<-ma-1.96*sse2
bci.low1<-mb-1.96*sse1
bci.low2<-ma+1.96*sse2
ls1<-subset(x=calf, subset=period=="before")$mean
ls2<-subset(x=calf, subset=period=="after")$mean
mb <- mean(ls1)
ma <- mean(ls2)
sse1<-my.se(ls1)
sse2<-my.se(ls2)
lci.up1<-mb+1.96*sse1
lci.up2<-ma-1.96*sse2
lci.low1<-mb-1.96*sse1
lci.low2<-ma+1.96*sse2
ns1<-subset(x=canf, subset=period=="before")$mean
ns2<-subset(x=canf, subset=period=="after")$mean
mb <- mean(ns1)
ma <- mean(ns2)
sse1<-my.se(ns1)
sse2<-my.se(ns2)
nci.up1<-mb+1.96*sse1
nci.up2<-ma-1.96*sse2
nci.low1<-mb-1.96*sse1
nci.low2<-ma+1.96*sse2
hs1<-subset(x=humf, subset=period=="before")$mean
hs2<-subset(x=humf, subset=period=="after")$mean
mb <- mean(hs1)
ma <- mean(hs2)
sse1<-my.se(hs1)
sse2<-my.se(hs2)
hci.up1<-mb+1.96*sse1
hci.up2<-ma-1.96*sse2
hci.low1<-mb-1.96*sse1
hci.low2<-ma+1.96*sse2
tab <- table(bs1,bs2,ls1,ls2,ns1,ns2,hs1,hs2)
tab <- c(bs1,bs2,ls1,ls2,ns1,ns2,hs1,hs2)
bp <- barplot(tab,ylim=c(0,0.5), names=c("before","after"), ylab="means", main="humboldt")
my.se <- function(x){
sd(x)/sqrt(length(x))
}
bs1<-subset(x=benf, subset=period=="before")$mean
bs2<-subset(x=benf, subset=period=="after")$mean
bmb <- mean(bs1)
bma <- mean(bs2)
sse1<-my.se(bs1)
sse2<-my.se(bs2)
bci.up1<-bmb+1.96*sse1
bci.up2<-bma-1.96*sse2
bci.low1<-bmb-1.96*sse1
bci.low2<-bma+1.96*sse2
ls1<-subset(x=calf, subset=period=="before")$mean
ls2<-subset(x=calf, subset=period=="after")$mean
lmb <- mean(ls1)
lma <- mean(ls2)
sse1<-my.se(ls1)
sse2<-my.se(ls2)
lci.up1<-lmb+1.96*sse1
lci.up2<-lma-1.96*sse2
lci.low1<-lmb-1.96*sse1
lci.low2<-lma+1.96*sse2
ns1<-subset(x=canf, subset=period=="before")$mean
ns2<-subset(x=canf, subset=period=="after")$mean
nmb <- mean(ns1)
nma <- mean(ns2)
sse1<-my.se(ns1)
sse2<-my.se(ns2)
nci.up1<-nmb+1.96*sse1
nci.up2<-nma-1.96*sse2
nci.low1<-nmb-1.96*sse1
nci.low2<-nma+1.96*sse2
hs1<-subset(x=humf, subset=period=="before")$mean
hs2<-subset(x=humf, subset=period=="after")$mean
hmb <- mean(hs1)
hma <- mean(hs2)
sse1<-my.se(hs1)
sse2<-my.se(hs2)
hci.up1<-hmb+1.96*sse1
hci.up2<-hma-1.96*sse2
hci.low1<-hmb-1.96*sse1
hci.low2<-hma+1.96*sse2
tab <- c(bmb,bma,lmb,lma,nmb,nma,hmb,hma)
bp <- barplot(tab,ylim=c(0,0.5), names=c("before","after"), ylab="means", main="humboldt")
tab <- table(bmb,bma,lmb,lma,nmb,nma,hmb,hma)
bp <- barplot(tab,ylim=c(0,0.5), names=c("before","after"), ylab="means", main="humboldt")
bp <- barplot(tab,ylim=c(0,0.5), ylab="means", main="humboldt")
p <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
(tab,ylim=c(0,1), ylab="means", main="humboldt")
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
tab <- c(bmb,bma,lmb,lma,nmb,nma,hmb,hma)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
tab <- cbind(c(bmb,bma),c(lmb,lma),c(nmb,nma),c(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
tab <- cbind(table(bmb,bma),c(lmb,lma),c(nmb,nma),c(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
tab <- cbind(table(bmb,bma),table(lmb,lma),table(nmb,nma),table(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
tab <- table(c(bmb,bma),c(lmb,lma),c(nmb,nma),c(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
tab <- c(c(bmb,bma),c(lmb,lma),c(nmb,nma),c(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
tab <- cbind(c(bmb,bma),c(lmb,lma),c(nmb,nma),c(hmb,hma))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt")
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt", beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt", xlab=c("benguela","california","canary","humboldt"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="humboldt", names=c("benguela","california","canary","humboldt"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="plot", names=c("benguela","california","canary","humboldt"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), xlab="location", beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), xlab="location", beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=1, y=1,legend = c("before","after"), col = c("dark grey", "light grey"), pch=c(19,1))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), xlab="location", beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("dark grey", "light grey"), pch=c(19,1))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,1))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means (left is before, right is after)", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
bp <- barplot(tab,ylim=c(0,1), ylab="means", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
bp <- barplot(tab,ylim=c(0,1), ylab="means m^2/s", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
bp <- barplot(tab,ylim=c(0,1), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
arrows(x0=bp,x1=bp,y0=c(bci.low1,bci.low2,lci.low1,lci.low2,nci.low1,nci.low2,hci.low1,hci.low2),y1=c(bci.up1,bci.up2,lci.up1,lci.up2,nci.up1,nci.up2,hci.up1,hci.up2),angle=90,code=3,length=0.1)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
hist(x_norm)
qqnorm(bs1)
qqline(bs1, col="red")
qqnorm(bs1)
qqline(bs1, col="red")
levene.test(tab)
leveneTest(tab)
leveneTest(tab[1])
# approximately normal, use Levene
library(car,quietly=TRUE)
leveneTest(tab)
leveneTest(tab$mean~tab$period)
leveneTest(benf$mean~benf$period)
View(benf)
leveneTest(benf$period~benf$mean)
View(benf)
leveneTest(benf$benguela.period~benf$mean)
View(benf)
leveneTest(subset(x=benf, subset=period=="before"),benf$mean)
leveneTest(subset(x=benf, subset=period=="before")~benf$mean)
leveneTest(benf$mean~benf$benguela.period)
leveneTest(benf$mean~benf$period)
benguela.
leveneTest(benf$mean~benf$benguela.period)
subset(x=benf, subset=period=="before")
leveneTest(calf$mean~calf$california.period)
leveneTest(canary$mean~canary$canary.period)
qqnorm(bs1)
qqline(bs1, col="red")
# approximately normal, use Levene
library(car,quietly=TRUE)
leveneTest(benf$mean~benf$benguela.period)
leveneTest(calf$mean~calf$california.period)
leveneTest(canf$mean~canf$canary.period)
leveneTest(humf$mean~humf$humboldt.period)
var(bs1, y = NULL, na.rm = FALSE, use)
var(bs1)
var(bs2)
tab <- cbind(c(vas(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,1), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.01), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.002), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.004), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.003), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.0025), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.0025), ylab="means (m^2/s)", main="multimodel avg means", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
bp <- barplot(tab,ylim=c(0,0.0025), ylab="variance", main="variances", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.0025), ylab="variance ((m^2/s)^2)", main="multimodel variances", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
tab <- cbind(c(var(bs1),var(bs2)),c(var(ls1),var(ls2)),c(var(ns1),var(ns2)),c(var(hs1),var(hs2)))
bp <- barplot(tab,ylim=c(0,0.0025), ylab="variance ((m^2/s)^2)", main="multimodel mean variances", names=c("benguela","california","canary","humboldt"), xlab="location", col=c("blue","green"), beside=TRUE)
legend(x=10, y=1,legend = c("before","after"), col = c("blue", "green"), pch=c(19,19))
